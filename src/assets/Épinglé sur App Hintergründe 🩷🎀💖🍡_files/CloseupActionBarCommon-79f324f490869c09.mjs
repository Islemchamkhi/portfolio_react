(self.modernJsonp=self.modernJsonp||[]).push([["55759"],{130442:function(e,t,n){n.r(t),n.d(t,{default:()=>D});var i=n(686659),o=n(667294),a=n(312048),r=n(20256),s=n(943564),l=n(724985),d=n(290852),c=n(689157),p=n(752031),u=n(746868),m=n(470205),g=n(935059),h=n(765603),x=n(774838),y=n(575820),v=n(200619),f=n(601871),C=n(15392),j=n(113759),b=n(632492),w=n(510755),P=n(328299),S=n(9065),_=n(785893);let k=(0,S.Z)(()=>Promise.all([n.e("25418"),n.e("68710"),n.e("42725"),n.e("98677"),n.e("64701")]).then(n.bind(n,785177)),void 0,e=>785177,"SaveAffordance",e=>["25418","68710","42725","98677","64701"]),I=(0,S.Z)(()=>n.e("73301").then(n.bind(n,225406)),void 0,e=>225406,"PostDownloadUpsellPopover",e=>["73301"]),B=(0,S.Z)(()=>Promise.resolve().then(n.bind(n,64897)),void 0,e=>64897,"SecondarySendButtonCommon",e=>[]),T=(0,S.Z)(()=>Promise.all([n.e("25418"),n.e("96415")]).then(n.bind(n,872901)),void 0,e=>872901,"ReactionPickerContainer",e=>["25418","96415"]),Z=(0,S.Z)(()=>n.e("8419").then(n.bind(n,78316)),void 0,e=>78316,"CloseupCommentButton",e=>["8419"]),A=(0,o.memo)(function({goBack:e,gridDescription:t,isDeletedStoryPin:n,inCommentsImprovedDropdownExp:i,inCommentsPopoverExp:S,isEligibleForAggregatedComments:A,isEligibleForPinReactions:D,isOnSecretBoard:E,onEditSubmit:R,pin:L,viewParameter:M,viewType:z,onSaveButtonClick:O,showRepinOnInitialRender:U,isStoryPin:W,actionBarContainerRef:F,outerPaddingSize:G=C.g9,maxWidth:Y,showLeadPin:H,scrollContainerRef:K}){let J=(0,a.TH)(),N=(0,v.Z)(),{showEnabledSaveBehavior:$}=(0,P.Yh)(!0),{imgSrc:q}=(0,p.G)(),{clientTrackingParams:X,showCloseupContentRight:Q,closeupWithinMasonryEnabled:V,peekCloseupEnabled:ee}=(0,j.x4)(),{viewType:et,viewParameter:en}=(0,u.SU)(),ei=(0,g.Z)(),eo=(0,f.q6)(ei,L?.pinner?.id,N),ea=(0,c.Z)({showProductDetailPage:!!L.is_eligible_for_pdp}),[er,es]=(0,o.useState)(!!(0,y.mB)(J.search).share),[el,ed]=(0,o.useState)(!1),{shareFromPostDownloadUpsell:ec,setShareFromPostDownloadUpsell:ep,saveToBoardFromPostDownloadUpsell:eu,setSaveToBoardFromPostDownloadUpsell:em}=(0,s.tS)();(0,o.useEffect)(()=>{ec&&(es(!0),ep(!1))},[ec,ep]);let eg=(0,o.useCallback)(e=>ed(e),[]),eh=(0,o.useCallback)(()=>es(!1),[]),ex=(0,o.useCallback)(()=>es(e=>!e),[]),ey=L.board?.owner?.id||L.pinner?.id,{aggregated_pin_data:ev,comments_disabled:ef,reaction_counts:eC}=L,{isRTL:ej}=(0,x.B)(),eb=V?Y:Y||C.Gg,ew=(0,d.Z)({pinKey:{type:"Legacy",data:L},orbacActingAs:N,viewer:ei}),eP=!!Object.keys(eC||{}).length,eS=ev?.did_it_data?.images_count??0,e_=(ev?.comment_count??0)+eS,ek=E||n?null:(0,_.jsx)(m.Z,{name:"CloseupActionBar_SecondarySendButton",children:(0,_.jsx)(B,{closeupWithinMasonryEnabled:V,controllerOptions:{flyoutDisplayOptions:V?{shownWithinProfileHeader:!0,idealDirection:"down",forceDirection:!0}:{wrapperPosition:"fixed"},isFlyoutOpen:er,loggingOptions:{component:194,element:72,viewParameter:M||en,viewType:z||et},onFlyoutDismiss:eh,onToggleFlyout:ex,sendObject:{type:"pin",description:t,id:L.id,imageUrl:q,ownerId:ey,url:`/pin/${L.id}/`,clientTrackingParams:X}},showSendAnimation:!0})}),eI=(0,_.jsx)(r.xu,{alignItems:"center",color:V?"transparent":"default","data-test-id":"closeup-action-items",display:"flex",justifyContent:"between",maxWidth:eb,role:"list",rounding:2,children:(0,_.jsxs)(r.kC,{alignItems:"stretch",gap:2*!!V,justifyContent:"start",children:[!eo&&!!D&&(0,_.jsx)(m.Z,{name:"CloseupActionBar_ReactionPickerContainer",children:(0,_.jsxs)(r.xu,{alignItems:"center",display:"flex",marginEnd:2*!!eP,role:"listitem",children:[(0,_.jsx)(T,{clientTrackingParams:X,handleReactionTrayHover:eg,idealDirection:V?"down":void 0,pinId:L.id,reactionByMe:L.reaction_by_me,showTooltip:!0,viewParameter:M,viewType:z}),(0,_.jsx)(h.Z,{pinId:L.id,reactionCounts:eC,showPrettyNumber:!0})]})}),V&&!(i&&ef)&&(0,_.jsx)(Z,{inCommentsImprovedDropdownExp:!!i,inCommentsPopoverExp:!!S,isEligibleForAggregatedComments:!!A,pinKey:{type:"Legacy",data:L},scrollContainerRef:K,shouldShowCommentCount:!ef&&!!e_&&(!!S||!!i),totalCommentCount:e_,viewParameter:M,viewType:z}),(0,_.jsx)(r.xu,{role:"listitem",children:ek}),(0,_.jsx)(r.xu,{"data-test-id":"closeup-more-options",role:"listitem",children:(0,_.jsx)(l.Z,{carouselSlotCurrentIndex:L&&L.carousel_data&&L.carousel_data.index,clientTrackingParams:X,closeupWithinMasonryEnabled:V,goBack:e,isReactionTrayOpen:el,onEditSubmit:R,pinKey:{type:"Legacy",data:L},showEditPin:!n&&ew,viewParameter:M,viewType:z})})]})}),eB=V?void 0:G,eT=(0,_.jsxs)(r.xu,{ref:F,color:"default",dangerouslySetInlineStyle:{__style:{paddingTop:G/2,paddingRight:ej?void 0:eB,paddingLeft:ej?eB:void 0,paddingBottom:V?G/2:void 0,borderRadius:W?"0px 32px 32px 32px":Q?"0px 32px 32px 0":void 0}},"data-test-id":"closeup-body-sticky-content",marginTop:V?0:W?-5:0,width:V?"100%":void 0,children:[(0,_.jsx)(r.xu,{"data-test-id":"closeupActionBar",marginStart:ea?-3:void 0,children:(0,_.jsxs)(r.kC,{alignItems:"stretch",justifyContent:"between",children:[eI,(0,_.jsx)(r.kC,{alignItems:"center",gap:2,children:!n&&!eo&&(0,_.jsx)(r.xu,{marginStart:3*!V,children:(0,_.jsx)(k,{boardCount:ei.isAuth?ei.boardCount:0,clientTrackingParams:X,onClickCallback:O,pinKey:{type:"Legacy",data:L},saveToBoardFromPostDownloadUpsell:eu,setSaveToBoardFromPostDownloadUpsell:em,showEnabledSaveBehavior:$,showRepinOnInitialRender:U,variant:"closeup",viewParameter:M,viewType:z})})})]})}),(0,_.jsx)(I,{})]});if(H||V)return eT;let eZ=W&&!ee?w.cI+4:w.hu;return ee&&(eZ=0),(0,_.jsx)(r.Le,{top:eZ,zIndex:b.mS,children:eT})});function D(e){return(0,o.useEffect)(()=>{(0,i.Z)("CloseupActionBar","/app/common/react/components/closeup/CloseupActionBar/CloseupActionBar.tsx")},[]),(0,_.jsx)(A,{...e})}},765603:function(e,t,n){n.d(t,{Z:()=>x});var i=n(667294),o=n(20256),a=n(361004),r=n(104999),s=n(24246),l=n(507006),d=n(729586),c=n(518596),p=n(825605),u=n(785893);function m(e,t,n){var i;return(t="symbol"==typeof(i=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?i:i+"")in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let g=(0,i.lazy)(()=>n.e("25993").then(n.bind(n,581897)));class h extends i.PureComponent{constructor(...e){super(...e),m(this,"state",{displayAggregationModal:!1}),m(this,"showAggregationModal",()=>{let{disableModal:e,logContextEvent:t}=this.props;e||(this.setState({displayAggregationModal:!0}),t({event_type:101,view_type:3,view_parameter:139,component:13458,element:11435,aux_data:{objectId:this.props.pinId}}))}),m(this,"hideAggregationModal",()=>{this.setState({displayAggregationModal:!1})})}render(){let{displayAggregationModal:e}=this.state,{isBold:t,isStoryPin:n,paddingY:i,pinId:r,reactionCounts:s,showPrettyNumber:m,size:h}=this.props,x=s?(0,c.At)(s):null,y=s?(0,c.Ud)(s):0,v=!!x&&x.length>0&&x.filter(e=>!!d.GY[e]).map((e,t)=>{let n=e&&d.GY[e]?d.GY[e]:"",{label:i,gridAsset:a}=(0,d.fW)(n,this.props.i18n);return(0,u.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{marginRight:2}},children:(0,u.jsx)(o.xu,{height:19,width:19,children:a&&(0,u.jsx)(o.Ee,{alt:i??"",fit:"cover",naturalHeight:1,naturalWidth:1,src:a})})},t)});return(0,u.jsxs)(o.xu,{children:[(0,u.jsx)(o.iP,{accessibilityLabel:`${y} reactions`,dataTestId:"reactions-count-button",onTap:this.showAggregationModal,children:!!v&&(0,u.jsx)(o.xu,{"data-test-id":"aggregated-reactions-container",display:"inlineBlock",children:m?(0,u.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{cursor:"pointer"}},children:(0,u.jsx)(o.xv,{size:h??a.n,weight:"bold",children:(0,u.jsx)(l.Z,{shortform:!0,shortformMaximumFractionDigits:1,value:y})})}):(0,u.jsxs)(o.xu,{alignItems:"center",dangerouslySetInlineStyle:{__style:{cursor:"pointer"}},"data-test-id":"aggregated-reactions-container",direction:"row",display:"flex",height:n?"auto":19,paddingY:i??6*!n,children:[(0,u.jsx)(o.kC,{alignItems:"stretch",direction:"row",justifyContent:"start",children:v}),(0,u.jsx)(o.xu,{paddingX:1,children:(0,u.jsx)(o.xv,{color:t?"default":"subtle",size:h??a.n,weight:t?"bold":"normal",children:(0,u.jsx)(l.Z,{shortform:!0,shortformMaximumFractionDigits:1,value:y})})})]})})}),e&&y&&(0,u.jsx)(p.Z,{children:(0,u.jsx)(g,{aggregatedReactions:v,onDismiss:this.hideAggregationModal,pinId:r,totalReactionCount:y})})]})}}m(h,"defaultProps",{isBold:!0});let x=function(e){let t=(0,s.Z)(),n=(0,r.Z)();return(0,u.jsx)(h,{...e,i18n:t,logContextEvent:n})}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/CloseupActionBarCommon-79f324f490869c09.mjs.map